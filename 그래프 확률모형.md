# 그래프 확률 모형

여러 확률변수의 결합분포를 구해야 하는 경우를 생각하자. 예를 들어 A, B, C, 3개의 확률변수가 있고 각 확률변수가 0, 1, 2 세가지의 값만 가질 수 있는 카테고리 확률변수인 경우 이 세 확률변수의 결합분포는 다음과 같이 표로 나타낼 수 있다. 이 표는 $3^3 - 1 = 26​$ 개의 모수를 가지므로 (합이 1이 되어야 하므로 하나는 다른 값들에 의존한다.) 이 표를 저장하려면 26개의 저장 공간이 필요하다.

| A    | B    | C    | P(A, B, C)     |
| ---- | ---- | ---- | -------------- |
| 0    | 0    | 0    | P(A=0,B=0,C=0) |
| 0    | 0    | 1    | P(A=0,B=0,C=1) |
| 0    | 0    | 2    | P(A=0,B=0,C=2) |
| 0    | 1    | 0    | P(A=0,B=1,C=0) |
| 0    | 1    | 1    | P(A=0,B=1,C=1) |
| 0    | 1    | 2    | P(A=0,B=1,C=2) |
| 0    | 2    | 0    | P(A=0,B=2,C=0) |
| 0    | 2    | 1    | P(A=0,B=2,C=1) |
| 0    | 2    | 2    | P(A=0,B=2,C=2) |
| 1    | 0    | 0    | P(A=1,B=0,C=0) |
| 1    | 0    | 1    | P(A=1,B=0,C=1) |
| 1    | 0    | 2    | P(A=1,B=0,C=2) |
| 1    | 1    | 0    | P(A=1,B=1,C=0) |
| 1    | 1    | 1    | P(A=1,B=1,C=1) |
| 1    | 1    | 2    | P(A=1,B=1,C=2) |
| 1    | 2    | 0    | P(A=1,B=2,C=0) |
| 1    | 2    | 1    | P(A=1,B=2,C=1) |
| 1    | 2    | 2    | P(A=1,B=2,C=2) |
| 2    | 0    | 0    | P(A=2,B=0,C=0) |
| 2    | 0    | 1    | P(A=2,B=0,C=1) |
| 2    | 0    | 2    | P(A=2,B=0,C=2) |
| 2    | 1    | 0    | P(A=2,B=1,C=0) |
| 2    | 1    | 1    | P(A=2,B=1,C=1) |
| 2    | 1    | 2    | P(A=2,B=1,C=2) |
| 2    | 2    | 0    | P(A=2,B=2,C=0) |
| 2    | 2    | 1    | P(A=2,B=2,C=1) |
| 2    | 2    | 2    | P(A=2,B=2,C=2) |

### 베이지안 네트워크 모형

그런데 현실에서는 모든 확률변수가 서로 영향을 미치는 복잡한 경우 보다 특정한 몇개의 확률분포들이 서로 영향을 미친다. 예를 들어 A, B, C가 각각 어떤 학생의

- A: 건강 상태
- B: 공부 시간
- C: 시험 성적

을 나타낸 것이라고 하자. 이 확률변수는 각각 $\{0, 1, 2\}$ 라는 값을 가질 수 있는데 하(0), 중(1), 상(2)의 상태를 나타낸다. 즉 $A = 0$이면 건강상태가 안좋은 것이고 $B = 1$ 이면 공부 시간이 보통이며 $C = 2$이면 시험 성적이 좋은 것이다.

공부 시간 $B$는 시험 성적 $C$에 영향을 미친다. 하지만 건강 상태 $A$는 공부 시간 $B$와 인과 관계가 있지만 시험 성적 $C$와는 직접적인 인과 관계가 없다. 이렇게 다수의 확률변수 중 특정한 소수의 확률변수들이 가지는 관계를 그래프로 표현한 것을 그래프 확률모형(graphical probability model)이라고 하고 그래프 확률모형 중에서도 이렇게 인과관계가 확실하여 방향성 그래프로 표시할 수 있는 것을 베이지안 네트워크 모형이라고 한다. 위의 확률변수를 베이지안 네트워크 모형으로 그리면 다음과 같다.

```python
import networkx as nx
from IPython.core.display import Image
from networkx.drawing.nx_pydot import to_pydot

g1 = nx.DiGraph()
g1.add_path(["A", "B", "C"])
d1 = to_pydot(g1)
d1.set_dpi(300)
d1.set_rankdir("LR")
d1.set_margin(0.2)
Image(d1.create_png(), width=600)
```

![](https://user-images.githubusercontent.com/17154958/51011461-f5d4f800-159b-11e9-804e-d0590b1cae0d.png)

이러한 그래프를 방향성 그래프(directed graph)라고 한다. 방향성 그래프에서 확률변수는 하나의 노드(node) 또는 정점(vertex)로 나타내고 인과관계는 화살표 간선(edge, link)으로 나타낸다.