# 서포트 벡터 머신

퍼셉트론은 가장 단순하고 빠른 판별 함수 기반 분류 모형이지만 판별 경계선(decision hyperplane)이 유니크하게 존재하지 않는다는 특징이 있다. 서포트 벡터 머신(SVM: support vector machine)은 퍼셉트론 기반의 모형에 가장 안정적인 판별 경계선을 찾기 위한 제한 조건을 추가한 모형이라고 볼 수 있다.

![서포트 벡터 머신](https://user-images.githubusercontent.com/17154958/50037459-d3ab9100-0054-11e9-918f-8fc5ffc2aaa7.png)



### 서포트와 마진

다음과 같이 $N$개의 학습용 데이터가 있다고 하자.
$$
(x_1, y_1), (x_2, y_2), \ldots, (x_i, y_i), \ldots, (x_N, y_N)
$$
여기에서 $y$는 +1, -1 두개의 값을 가진다.
$$
y = \begin{cases} +1 \\ -1 \end{cases}
$$
$x$ 데이터 중에서 $y$값이 +1인 데이터를 $x_+$, $y$값이 -1인 데이터를 $x_-$라고 하자. 

판별함수 모형에서 직선인 판별 함수 $f(x)$는 다음과 같은 수식으로 나타낼 수 있다.
$$
f(x) = w^Tx - w_0
$$
판별함수의 정의에 따라 $y$값이 +1인 그 데이터 $x_+$에 대한 판별함수 값은 양수가 된다.
$$
f(x_+) = w^Tx_+ - w_0 \gt 0
$$
반대로 $y$값이 -1인 그 데이터 $x_-$에 대한 판별함수 값은 음수가 된다.
$$
f(x_-) = w^Tx_- - w_0 < 0
$$
$y$값이 +1인 데이터 중에서 판별 함수의 값이 가장 작은 데이터를 $x^+$라 하고 $y$값이 -1인 데이터 중에서 판별함수의 값이 가장 큰 데이터를 $x^-$라고 하자. 이 데이터들은 각각의 클래스에 속한 데이터 중에서 가장 경계선에 가까이 붙어있는 최전방(most front)의 데이터들이다. 이러한 데이터를 **서포트(support)** 혹은 **서포트 벡터(support vertor)**라고 한다. 물론 이 서포트에 대해서도 부호 조건은 만족되어야 한다.
$$
f(x^+) = w^Tx^+ - w_0 > 0 \\
f(x^-) = w^Tx^- - w_0 < 0
$$
서포트에 대한 판별 함수의 값 $f(x^+), f(x^-)$ 값은 부호 조건만 지키면 어떤 값이 되어도 괜찮다. 따라서 다음과 같은 조건을 만족하도록 판별함수를 구한다.
$$
f(x^+) = w^T x^{+} - w_0 = +1 \\
f(x^-) = w^T x^{-} - w_0 = -1
$$
이렇게 되면 모든 $x_-$, $x_+$ 데이터에 대해 판별함수의 값의 절대값이 1보다 커지므로 다음 부등식이 성립한다.
$$
w^Tx_+ - w_0 \ge 1 \\
w^Tx_- -w_0 \le -1
$$
판별 경계선 $w^Tx -w_0 = 0$과 점 $x^+, x^-$사이의 거리는 다음과 같이 계산할 수 있다.

